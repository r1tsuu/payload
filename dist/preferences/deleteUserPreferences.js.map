{"version":3,"sources":["../../src/preferences/deleteUserPreferences.ts"],"sourcesContent":["import type { SanitizedCollectionConfig } from '../collections/config/types.js'\nimport type { Payload } from '../index.js'\nimport type { PayloadRequestWithData } from '../types/index.js'\n\ntype Args = {\n  collectionConfig: SanitizedCollectionConfig\n  /**\n   * User IDs to delete\n   */\n  ids: (number | string)[]\n  payload: Payload\n  req: PayloadRequestWithData\n}\nexport const deleteUserPreferences = async ({ collectionConfig, ids, payload, req }: Args) => {\n  if (collectionConfig.auth) {\n    await payload.db.deleteMany({\n      collection: 'payload-preferences',\n      req,\n      where: {\n        and: [\n          {\n            'user.value': { in: ids },\n          },\n          {\n            'user.relationTo': { equals: collectionConfig.slug },\n          },\n        ],\n      },\n    })\n  }\n  await payload.db.deleteMany({\n    collection: 'payload-preferences',\n    req,\n    where: {\n      key: { in: ids.map((id) => `collection-${collectionConfig.slug}-${id}`) },\n    },\n  })\n}\n"],"names":["deleteUserPreferences","collectionConfig","ids","payload","req","auth","db","deleteMany","collection","where","and","in","equals","slug","key","map","id"],"mappings":"AAaA,OAAO,MAAMA,wBAAwB,OAAO,EAAEC,gBAAgB,EAAEC,GAAG,EAAEC,OAAO,EAAEC,GAAG,EAAQ;IACvF,IAAIH,iBAAiBI,IAAI,EAAE;QACzB,MAAMF,QAAQG,EAAE,CAACC,UAAU,CAAC;YAC1BC,YAAY;YACZJ;YACAK,OAAO;gBACLC,KAAK;oBACH;wBACE,cAAc;4BAAEC,IAAIT;wBAAI;oBAC1B;oBACA;wBACE,mBAAmB;4BAAEU,QAAQX,iBAAiBY,IAAI;wBAAC;oBACrD;iBACD;YACH;QACF;IACF;IACA,MAAMV,QAAQG,EAAE,CAACC,UAAU,CAAC;QAC1BC,YAAY;QACZJ;QACAK,OAAO;YACLK,KAAK;gBAAEH,IAAIT,IAAIa,GAAG,CAAC,CAACC,KAAO,CAAC,WAAW,EAAEf,iBAAiBY,IAAI,CAAC,CAAC,EAAEG,GAAG,CAAC;YAAE;QAC1E;IACF;AACF,EAAC"}