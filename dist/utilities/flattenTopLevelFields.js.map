{"version":3,"sources":["../../src/utilities/flattenTopLevelFields.ts"],"sourcesContent":["import type { ClientFieldConfig } from '../fields/config/client.js'\nimport type { Field, FieldAffectingData, FieldPresentationalOnly } from '../fields/config/types.js'\n\nimport {\n  fieldAffectsData,\n  fieldHasSubFields,\n  fieldIsPresentationalOnly,\n  tabHasName,\n} from '../fields/config/types.js'\n\n/**\n * Flattens a collection's fields into a single array of fields, as long\n * as the fields do not affect data.\n *\n * @param fields\n * @param keepPresentationalFields if true, will skip flattening fields that are presentational only\n */\nconst flattenFields = (\n  fields: (ClientFieldConfig | Field)[],\n  keepPresentationalFields?: boolean,\n): (FieldAffectingData | FieldPresentationalOnly)[] => {\n  return fields.reduce((fieldsToUse, field) => {\n    if (fieldAffectsData(field) || (keepPresentationalFields && fieldIsPresentationalOnly(field))) {\n      return [...fieldsToUse, field]\n    }\n\n    if (fieldHasSubFields(field)) {\n      return [...fieldsToUse, ...flattenFields(field.fields, keepPresentationalFields)]\n    }\n\n    if (field.type === 'tabs' && 'tabs' in field) {\n      return [\n        ...fieldsToUse,\n        ...field.tabs.reduce((tabFields, tab) => {\n          return [\n            ...tabFields,\n            ...(tabHasName(tab)\n              ? [{ ...tab, type: 'tab' }]\n              : flattenFields(tab.fields, keepPresentationalFields)),\n          ]\n        }, []),\n      ]\n    }\n\n    return fieldsToUse\n  }, [])\n}\n\nexport default flattenFields\n"],"names":["fieldAffectsData","fieldHasSubFields","fieldIsPresentationalOnly","tabHasName","flattenFields","fields","keepPresentationalFields","reduce","fieldsToUse","field","type","tabs","tabFields","tab"],"mappings":"AAGA,SACEA,gBAAgB,EAChBC,iBAAiB,EACjBC,yBAAyB,EACzBC,UAAU,QACL,4BAA2B;AAElC;;;;;;CAMC,GACD,MAAMC,gBAAgB,CACpBC,QACAC;IAEA,OAAOD,OAAOE,MAAM,CAAC,CAACC,aAAaC;QACjC,IAAIT,iBAAiBS,UAAWH,4BAA4BJ,0BAA0BO,QAAS;YAC7F,OAAO;mBAAID;gBAAaC;aAAM;QAChC;QAEA,IAAIR,kBAAkBQ,QAAQ;YAC5B,OAAO;mBAAID;mBAAgBJ,cAAcK,MAAMJ,MAAM,EAAEC;aAA0B;QACnF;QAEA,IAAIG,MAAMC,IAAI,KAAK,UAAU,UAAUD,OAAO;YAC5C,OAAO;mBACFD;mBACAC,MAAME,IAAI,CAACJ,MAAM,CAAC,CAACK,WAAWC;oBAC/B,OAAO;2BACFD;2BACCT,WAAWU,OACX;4BAAC;gCAAE,GAAGA,GAAG;gCAAEH,MAAM;4BAAM;yBAAE,GACzBN,cAAcS,IAAIR,MAAM,EAAEC;qBAC/B;gBACH,GAAG,EAAE;aACN;QACH;QAEA,OAAOE;IACT,GAAG,EAAE;AACP;AAEA,eAAeJ,cAAa"}