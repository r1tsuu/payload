{"version":3,"sources":["../../src/auth/executeAccess.ts"],"sourcesContent":["import type { Access, AccessResult } from '../config/types.js'\nimport type { PayloadRequestWithData } from '../types/index.js'\n\nimport { Forbidden } from '../errors/index.js'\n\ntype OperationArgs = {\n  data?: any\n  disableErrors?: boolean\n  id?: number | string\n  isReadingStaticFile?: boolean\n  req: PayloadRequestWithData\n}\nconst executeAccess = async (\n  { id, data, disableErrors, isReadingStaticFile = false, req }: OperationArgs,\n  access: Access,\n): Promise<AccessResult> => {\n  if (access) {\n    const result = await access({\n      id,\n      data,\n      isReadingStaticFile,\n      req,\n    })\n\n    if (!result) {\n      if (!disableErrors) throw new Forbidden(req.t)\n    }\n\n    return result\n  }\n\n  if (req.user) {\n    return true\n  }\n\n  if (!disableErrors) throw new Forbidden(req.t)\n  return false\n}\n\nexport default executeAccess\n"],"names":["Forbidden","executeAccess","id","data","disableErrors","isReadingStaticFile","req","access","result","t","user"],"mappings":"AAGA,SAASA,SAAS,QAAQ,qBAAoB;AAS9C,MAAMC,gBAAgB,OACpB,EAAEC,EAAE,EAAEC,IAAI,EAAEC,aAAa,EAAEC,sBAAsB,KAAK,EAAEC,GAAG,EAAiB,EAC5EC;IAEA,IAAIA,QAAQ;QACV,MAAMC,SAAS,MAAMD,OAAO;YAC1BL;YACAC;YACAE;YACAC;QACF;QAEA,IAAI,CAACE,QAAQ;YACX,IAAI,CAACJ,eAAe,MAAM,IAAIJ,UAAUM,IAAIG,CAAC;QAC/C;QAEA,OAAOD;IACT;IAEA,IAAIF,IAAII,IAAI,EAAE;QACZ,OAAO;IACT;IAEA,IAAI,CAACN,eAAe,MAAM,IAAIJ,UAAUM,IAAIG,CAAC;IAC7C,OAAO;AACT;AAEA,eAAeR,cAAa"}