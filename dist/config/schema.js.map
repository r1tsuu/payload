{"version":3,"sources":["../../src/config/schema.ts"],"sourcesContent":["import joi from 'joi'\n\nimport { adminViewSchema } from './shared/adminViewSchema.js'\nimport { componentSchema, livePreviewSchema } from './shared/componentSchema.js'\nimport { openGraphSchema } from './shared/openGraphSchema.js'\n\nconst component = joi.alternatives().try(joi.object().unknown(), joi.func())\n\nexport const endpointsSchema = joi.alternatives().try(\n  joi.array().items(\n    joi.object({\n      custom: joi.object().pattern(joi.string(), joi.any()),\n      handler: joi.alternatives().try(joi.array().items(joi.func()), joi.func()),\n      method: joi\n        .string()\n        .valid('get', 'head', 'post', 'put', 'patch', 'delete', 'connect', 'options'),\n      path: joi.string(),\n      root: joi.bool(),\n    }),\n  ),\n  joi.boolean(),\n)\n\nexport default joi.object({\n  admin: joi.object({\n    autoLogin: joi.alternatives().try(\n      joi.object().keys({\n        email: joi.string(),\n        password: joi.string(),\n        prefillOnly: joi.boolean(),\n      }),\n      joi.boolean(),\n    ),\n    avatar: joi.alternatives().try(joi.string(), component),\n    buildPath: joi.string(),\n    components: joi.object().keys({\n      Nav: component,\n      actions: joi.array().items(component),\n      afterDashboard: joi.array().items(component),\n      afterLogin: joi.array().items(component),\n      afterNavLinks: joi.array().items(component),\n      beforeDashboard: joi.array().items(component),\n      beforeLogin: joi.array().items(component),\n      beforeNavLinks: joi.array().items(component),\n      graphics: joi.object({\n        Icon: component,\n        Logo: component,\n      }),\n      logout: joi.object({\n        Button: component,\n      }),\n      providers: joi.array().items(component),\n      views: joi.alternatives().try(\n        joi.object({\n          Account: joi.alternatives().try(component, adminViewSchema),\n          Dashboard: joi.alternatives().try(component, adminViewSchema),\n        }),\n        joi.object().pattern(joi.string(), component),\n      ),\n    }),\n    custom: joi.object().pattern(joi.string(), joi.any()),\n    dateFormat: joi.string(),\n    disable: joi.bool(),\n    livePreview: joi.object({\n      ...livePreviewSchema,\n      collections: joi.array().items(joi.string()),\n      globals: joi.array().items(joi.string()),\n    }),\n    meta: joi.object().keys({\n      defaultOGImageType: joi.string().valid('off', 'dynamic', 'static'),\n      description: joi.string(),\n      icons: joi.array().items(\n        joi.object().keys({\n          type: joi.string(),\n          color: joi.string(),\n          fetchPriority: joi.string().valid('auto', 'high', 'low'),\n          media: joi.string(),\n          rel: joi.string(),\n          sizes: joi.string(),\n          url: joi.string(),\n        }),\n      ),\n      openGraph: openGraphSchema,\n      titleSuffix: joi.string(),\n    }),\n    routes: joi.object({\n      account: joi.string(),\n      createFirstUser: joi.string(),\n      forgot: joi.string(),\n      inactivity: joi.string(),\n      login: joi.string(),\n      logout: joi.string(),\n      reset: joi.string(),\n      unauthorized: joi.string(),\n    }),\n    user: joi.string(),\n  }),\n  bin: joi.array().items(\n    joi.object().keys({\n      key: joi.string(),\n      scriptPath: joi.string(),\n    }),\n  ),\n  collections: joi.array(),\n  cookiePrefix: joi.string(),\n  cors: [joi.string().valid('*'), joi.array().items(joi.string())],\n  csrf: joi.array().items(joi.string().allow('')).sparse(),\n  custom: joi.object().pattern(joi.string(), joi.any()),\n  db: joi.any(),\n  debug: joi.boolean(),\n  defaultDepth: joi.number().min(0).max(30),\n  defaultMaxTextLength: joi.number(),\n  editor: joi\n    .object()\n    .optional()\n    .keys({\n      CellComponent: componentSchema.optional(),\n      FieldComponent: componentSchema.optional(),\n      afterReadPromise: joi.func().optional(),\n      outputSchema: joi.func().optional(),\n      populationPromise: joi.func().optional(),\n      validate: joi.func().required(),\n    })\n    .unknown(),\n  email: joi.alternatives().try(joi.object(), joi.func()),\n  endpoints: endpointsSchema,\n  globals: joi.array(),\n  graphQL: joi.object().keys({\n    disable: joi.boolean(),\n    disablePlaygroundInProduction: joi.boolean(),\n    maxComplexity: joi.number(),\n    mutations: joi.function(),\n    queries: joi.function(),\n    schemaOutputFile: joi.string(),\n  }),\n  hooks: joi.object().keys({\n    afterError: joi.func(),\n  }),\n  i18n: joi.object(),\n  indexSortableFields: joi.boolean(),\n  local: joi.boolean(),\n  localization: joi.alternatives().try(\n    joi.object().keys({\n      defaultLocale: joi.string(),\n      fallback: joi.boolean(),\n      localeCodes: joi.array().items(joi.string()),\n      locales: joi.alternatives().try(\n        joi.array().items(\n          joi.object().keys({\n            code: joi.string(),\n            fallbackLocale: joi.string(),\n            label: joi\n              .alternatives()\n              .try(\n                joi.object().pattern(joi.string(), [joi.string()]),\n                joi.string(),\n                joi.valid(false),\n              ),\n            rtl: joi.boolean(),\n            toString: joi.func(),\n          }),\n        ),\n        joi.array().items(joi.string()),\n      ),\n    }),\n    joi.boolean(),\n  ),\n  maxDepth: joi.number().min(0).max(100),\n  onInit: joi.func(),\n  plugins: joi.array().items(joi.func()),\n  routes: joi.object({\n    admin: joi.string(),\n    api: joi.string(),\n    graphQL: joi.string(),\n    graphQLPlayground: joi.string(),\n  }),\n  secret: joi.string(),\n  serverURL: joi\n    .string()\n    .uri()\n    .allow('')\n    .custom((value, helper) => {\n      const urlWithoutProtocol = value.split('//')[1]\n\n      if (!urlWithoutProtocol) {\n        return helper.message({\n          custom: 'You need to include either \"https://\" or \"http://\" in your serverURL.',\n        })\n      }\n\n      if (urlWithoutProtocol.indexOf('/') > -1) {\n        return helper.message({\n          custom:\n            'Your serverURL cannot have a path. It can only contain a protocol, a domain, and an optional port.',\n        })\n      }\n\n      return value\n    }),\n  sharp: joi.any(),\n  telemetry: joi.boolean(),\n  typescript: joi.object({\n    autoGenerate: joi.boolean(),\n    declare: joi.alternatives().try(joi.boolean(), joi.object({ ignoreTSError: joi.boolean() })),\n    definitions: joi.object(),\n    outputFile: joi.string(),\n  }),\n  upload: joi.object(),\n})\n"],"names":["joi","adminViewSchema","componentSchema","livePreviewSchema","openGraphSchema","component","alternatives","try","object","unknown","func","endpointsSchema","array","items","custom","pattern","string","any","handler","method","valid","path","root","bool","boolean","admin","autoLogin","keys","email","password","prefillOnly","avatar","buildPath","components","Nav","actions","afterDashboard","afterLogin","afterNavLinks","beforeDashboard","beforeLogin","beforeNavLinks","graphics","Icon","Logo","logout","Button","providers","views","Account","Dashboard","dateFormat","disable","livePreview","collections","globals","meta","defaultOGImageType","description","icons","type","color","fetchPriority","media","rel","sizes","url","openGraph","titleSuffix","routes","account","createFirstUser","forgot","inactivity","login","reset","unauthorized","user","bin","key","scriptPath","cookiePrefix","cors","csrf","allow","sparse","db","debug","defaultDepth","number","min","max","defaultMaxTextLength","editor","optional","CellComponent","FieldComponent","afterReadPromise","outputSchema","populationPromise","validate","required","endpoints","graphQL","disablePlaygroundInProduction","maxComplexity","mutations","function","queries","schemaOutputFile","hooks","afterError","i18n","indexSortableFields","local","localization","defaultLocale","fallback","localeCodes","locales","code","fallbackLocale","label","rtl","toString","maxDepth","onInit","plugins","api","graphQLPlayground","secret","serverURL","uri","value","helper","urlWithoutProtocol","split","message","indexOf","sharp","telemetry","typescript","autoGenerate","declare","ignoreTSError","definitions","outputFile","upload"],"mappings":"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"}