{"version":3,"sources":["../../src/uploads/getFileByPath.ts"],"sourcesContent":["import { fileTypeFromFile } from 'file-type'\nimport fs from 'fs'\nimport path from 'path'\n\nimport type { PayloadRequestWithData } from '../types/index.js'\n\nconst mimeTypeEstimate = {\n  svg: 'image/svg+xml',\n}\n\nexport const getFileByPath = async (filePath: string): Promise<PayloadRequestWithData['file']> => {\n  if (typeof filePath === 'string') {\n    const data = fs.readFileSync(filePath)\n    const mimetype = fileTypeFromFile(filePath)\n    const { size } = fs.statSync(filePath)\n\n    const name = path.basename(filePath)\n    const ext = path.extname(filePath).slice(1)\n\n    const mime = (await mimetype)?.mime || mimeTypeEstimate[ext]\n\n    return {\n      name,\n      data,\n      mimetype: mime,\n      size,\n    }\n  }\n\n  return undefined\n}\n"],"names":["fileTypeFromFile","fs","path","mimeTypeEstimate","svg","getFileByPath","filePath","data","readFileSync","mimetype","size","statSync","name","basename","ext","extname","slice","mime","undefined"],"mappings":"AAAA,SAASA,gBAAgB,QAAQ,YAAW;AAC5C,OAAOC,QAAQ,KAAI;AACnB,OAAOC,UAAU,OAAM;AAIvB,MAAMC,mBAAmB;IACvBC,KAAK;AACP;AAEA,OAAO,MAAMC,gBAAgB,OAAOC;IAClC,IAAI,OAAOA,aAAa,UAAU;QAChC,MAAMC,OAAON,GAAGO,YAAY,CAACF;QAC7B,MAAMG,WAAWT,iBAAiBM;QAClC,MAAM,EAAEI,IAAI,EAAE,GAAGT,GAAGU,QAAQ,CAACL;QAE7B,MAAMM,OAAOV,KAAKW,QAAQ,CAACP;QAC3B,MAAMQ,MAAMZ,KAAKa,OAAO,CAACT,UAAUU,KAAK,CAAC;QAEzC,MAAMC,OAAO,AAAC,CAAA,MAAMR,QAAO,GAAIQ,QAAQd,gBAAgB,CAACW,IAAI;QAE5D,OAAO;YACLF;YACAL;YACAE,UAAUQ;YACVP;QACF;IACF;IAEA,OAAOQ;AACT,EAAC"}