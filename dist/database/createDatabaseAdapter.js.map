{"version":3,"sources":["../../src/database/createDatabaseAdapter.ts"],"sourcesContent":["/* eslint-disable no-param-reassign */\nimport type { MarkOptional } from 'ts-essentials'\n\nimport type {\n  BaseDatabaseAdapter,\n  BeginTransaction,\n  CommitTransaction,\n  RollbackTransaction,\n} from './types.js'\n\nimport { createMigration } from './migrations/createMigration.js'\nimport { migrate } from './migrations/migrate.js'\nimport { migrateDown } from './migrations/migrateDown.js'\nimport { migrateRefresh } from './migrations/migrateRefresh.js'\nimport { migrateReset } from './migrations/migrateReset.js'\nimport { migrateStatus } from './migrations/migrateStatus.js'\n\nconst beginTransaction: BeginTransaction = async () => null\nconst rollbackTransaction: RollbackTransaction = async () => null\nconst commitTransaction: CommitTransaction = async () => null\n\nexport function createDatabaseAdapter<T extends BaseDatabaseAdapter>(\n  args: MarkOptional<\n    T,\n    | 'createMigration'\n    | 'migrate'\n    | 'migrateDown'\n    | 'migrateFresh'\n    | 'migrateRefresh'\n    | 'migrateReset'\n    | 'migrateStatus'\n    | 'migrationDir'\n  >,\n): T {\n  return {\n    // Default 'null' transaction functions\n    beginTransaction,\n    commitTransaction,\n    createMigration,\n    migrate,\n    migrateDown,\n    migrateFresh: async ({ forceAcceptWarning = null }) => null,\n    migrateRefresh,\n    migrateReset,\n    migrateStatus,\n    rollbackTransaction,\n\n    ...args,\n\n    // Ensure migrationDir is set\n    migrationDir: args.migrationDir || 'migrations',\n  } as T\n}\n"],"names":["createMigration","migrate","migrateDown","migrateRefresh","migrateReset","migrateStatus","beginTransaction","rollbackTransaction","commitTransaction","createDatabaseAdapter","args","migrateFresh","forceAcceptWarning","migrationDir"],"mappings":"AAAA,oCAAoC,GAUpC,SAASA,eAAe,QAAQ,kCAAiC;AACjE,SAASC,OAAO,QAAQ,0BAAyB;AACjD,SAASC,WAAW,QAAQ,8BAA6B;AACzD,SAASC,cAAc,QAAQ,iCAAgC;AAC/D,SAASC,YAAY,QAAQ,+BAA8B;AAC3D,SAASC,aAAa,QAAQ,gCAA+B;AAE7D,MAAMC,mBAAqC,UAAY;AACvD,MAAMC,sBAA2C,UAAY;AAC7D,MAAMC,oBAAuC,UAAY;AAEzD,OAAO,SAASC,sBACdC,IAUC;IAED,OAAO;QACL,uCAAuC;QACvCJ;QACAE;QACAR;QACAC;QACAC;QACAS,cAAc,OAAO,EAAEC,qBAAqB,IAAI,EAAE,GAAK;QACvDT;QACAC;QACAC;QACAE;QAEA,GAAGG,IAAI;QAEP,6BAA6B;QAC7BG,cAAcH,KAAKG,YAAY,IAAI;IACrC;AACF"}